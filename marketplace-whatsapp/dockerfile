# ================================================================
# ğŸ—ï¸ Ã‰TAPE 1 : Construire lâ€™application React
# ================================================================
FROM node:18 AS build

# CrÃ©er un dossier de travail
WORKDIR /app

# Copier les fichiers nÃ©cessaires pour installer les dÃ©pendances
COPY package*.json ./

# Installer les dÃ©pendances
RUN npm install

# Copier tout le reste du projet dans lâ€™image Docker
COPY . .

# Construire lâ€™application pour la production
RUN npm run build


# ================================================================
# ğŸš€ Ã‰TAPE 2 : Servir lâ€™application avec Nginx
# ================================================================
FROM nginx:stable-alpine

# Copier le build gÃ©nÃ©rÃ© depuis lâ€™Ã©tape prÃ©cÃ©dente vers le dossier de Nginx
COPY --from=build /app/build /usr/share/nginx/html

# Exposer le port 80 (port HTTP par dÃ©faut)
EXPOSE 80

# Lancer Nginx en mode "foreground"
CMD ["nginx", "-g", "daemon off;"]
